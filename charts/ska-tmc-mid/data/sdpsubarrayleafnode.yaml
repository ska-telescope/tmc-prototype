name: "sdpsubarayleafnode-{{.Release.Name}}"
function: observation-execution
domain: subarray
instances: ["01", "02", "03"]
command: "SdpSubarrayLeafNodeDS"
# entrypoints:
#   - name: "ska_tmc_sdpsubarrayleafnode_mid.sdp_subarray_leaf_node.SdpSubarrayLeafNode"
server:
  name: "SdpSubarrayLeafNodeDS"
  instances:
  {{- range  .Values.coalesced_subarray_devices }}
    - name: "{{ . }}"
      classes:
        - name: "SdpSubarrayLeafNode"
          devices:
            - name: "ska_mid/tm_leaf_node/sdp_subarray{{ . }}"
              properties:
                - name: "SdpSubarrayFQDN"
                  values:
                    - "mid_sdp/elt/subarray_{{ (split "0" .)._1}}"
                - name: "SkaLevel"
                  values:
                    - "3"
                - name: "LoggingTargetsDefault"
                  values:
                    - "tango::logger"
                - name: "LoggingLevelDefault"
                  values:
                    - "5"
                - name: "polled_attr"
                  values:
                    - "healthstate"
                    - "1000"
                    - "receiveAddresses"
                    - "1000"
              attribute_properties:
                - attribute: "healthState"
                  properties:
                    - name: "abs_change"
                      values:
                        - "-1"
                        - "1"
  {{- end }}
depends_on:
  - device: sys/database/2
image:
  registry: "{{.Values.global.skatmc.registry}}"
  image: "{{.Values.global.skatmc.image}}"
  tag: "{{.Values.global.skatmc.tag}}"
  pullPolicy: "{{.Values.global.skatmc.pullPolicy}}"
environment_variables:
  - name: STANDALONE_MODE
    value: "'{{.Values.global.standalone_mode}}'"
