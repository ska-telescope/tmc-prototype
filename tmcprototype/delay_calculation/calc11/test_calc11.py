#!/usr/bin/env python3

import numpy as np
from calc11 import almacalc
import matplotlib.pyplot as plt

nant = 1   # Number of antenna
ntimes = 1440  # Number of timestamps

# Reference Antenna ECEF coorinates in meters
refx = 5109359.65317832
refy = 2006852.39745255
refz =-3238947.8210535827

# Antenna1 ECEF coorinates in meters  5108382.137945333, 2010429.0438966767, -3238301.3955808613
antx = np.array([5108382.137945333])
anty = np.array([2010429.0438966767])
antz = np.array([-3238301.3955808613])

temp = np.array([0.0])  # Temperature = 0 degree celsius
pressure = np.array([0.0])  # Pressure = 0 hPa
humidity =  np.array([0.0])

# Array of Modified Julian Date (MJD) ranging from 00:00:00.000 to 23:59:00.000 at an interval of 1 min on 2019-08-06
mjd = np.array([58701.0, 58701.0006944444, 58701.001388888806, 58701.00208333321, 58701.00277777761, 58701.003472222015, 58701.004166666884, 58701.00486111129, 58701.00555555569, 58701.00625000009, 58701.006944444496, 58701.0076388889, 58701.0083333333, 58701.009027777705, 58701.00972222211, 58701.01041666651, 58701.011111110914, 58701.01180555578, 58701.012500000186, 58701.01319444459, 58701.01388888899, 58701.014583333395, 58701.0152777778, 58701.0159722222, 58701.016666666605, 58701.01736111101, 58701.01805555541, 58701.018749999814, 58701.01944444422, 58701.020138889086, 58701.02083333349, 58701.02152777789, 58701.022222222295, 58701.0229166667, 58701.0236111111, 58701.024305555504, 58701.02499999991, 58701.02569444431, 58701.02638888871, 58701.027083333116, 58701.027777777985, 58701.02847222239, 58701.02916666679, 58701.029861111194, 58701.0305555556, 58701.03125, 58701.0319444444, 58701.032638888806, 58701.03333333321, 58701.03402777761, 58701.034722222015, 58701.035416666884, 58701.03611111129, 58701.03680555569, 58701.03750000009, 58701.038194444496, 58701.0388888889, 58701.0395833333, 58701.040277777705, 58701.04097222211, 58701.04166666651, 58701.042361110914, 58701.04305555578, 58701.043750000186, 58701.04444444459, 58701.04513888899, 58701.045833333395, 58701.0465277778, 58701.0472222222, 58701.047916666605, 58701.04861111101, 58701.04930555541, 58701.049999999814, 58701.05069444422, 58701.051388889086, 58701.05208333349, 58701.05277777789, 58701.053472222295, 58701.0541666667, 58701.0548611111, 58701.055555555504, 58701.05624999991, 58701.05694444431, 58701.05763888871, 58701.058333333116, 58701.059027777985, 58701.05972222239, 58701.06041666679, 58701.061111111194, 58701.0618055556, 58701.0625, 58701.0631944444, 58701.063888888806, 58701.06458333321, 58701.06527777761, 58701.065972222015, 58701.066666666884, 58701.06736111129, 58701.06805555569, 58701.06875000009, 58701.069444444496, 58701.0701388889, 58701.0708333333, 58701.071527777705, 58701.07222222211, 58701.07291666651, 58701.073611110914, 58701.07430555578, 58701.075000000186, 58701.07569444459, 58701.07638888899, 58701.077083333395, 58701.0777777778, 58701.0784722222, 58701.079166666605, 58701.07986111101, 58701.08055555541, 58701.081249999814, 58701.08194444422, 58701.082638889086, 58701.08333333349, 58701.08402777789, 58701.084722222295, 58701.0854166667, 58701.0861111111, 58701.086805555504, 58701.08749999991, 58701.08819444431, 58701.08888888871, 58701.089583333116, 58701.090277777985, 58701.09097222239, 58701.09166666679, 58701.092361111194, 58701.0930555556, 58701.09375, 58701.0944444444, 58701.095138888806, 58701.09583333321, 58701.09652777761, 58701.097222222015, 58701.097916666884, 58701.09861111129, 58701.09930555569, 58701.10000000009, 58701.100694444496, 58701.1013888889, 58701.1020833333, 58701.102777777705, 58701.10347222211, 58701.10416666651, 58701.104861110914, 58701.10555555578, 58701.106250000186, 58701.10694444459, 58701.10763888899, 58701.108333333395, 58701.1090277778, 58701.1097222222, 58701.110416666605, 58701.11111111101, 58701.11180555541, 58701.112499999814, 58701.11319444422, 58701.113888889086, 58701.11458333349, 58701.11527777789, 58701.115972222295, 58701.1166666667, 58701.1173611111, 58701.118055555504, 58701.11874999991, 58701.11944444431, 58701.12013888871, 58701.120833333116, 58701.121527777985, 58701.12222222239, 58701.12291666679, 58701.123611111194, 58701.1243055556, 58701.125, 58701.1256944444, 58701.126388888806, 58701.12708333321, 58701.12777777761, 58701.128472222015, 58701.129166666884, 58701.12986111129, 58701.13055555569, 58701.13125000009, 58701.131944444496, 58701.1326388889, 58701.1333333333, 58701.134027777705, 58701.13472222211, 58701.13541666651, 58701.136111110914, 58701.13680555578, 58701.137500000186, 58701.13819444459, 58701.13888888899, 58701.139583333395, 58701.1402777778, 58701.1409722222, 58701.141666666605, 58701.14236111101, 58701.14305555541, 58701.143749999814, 58701.14444444422, 58701.145138889086, 58701.14583333349, 58701.14652777789, 58701.147222222295, 58701.1479166667, 58701.1486111111, 58701.149305555504, 58701.14999999991, 58701.15069444431, 58701.15138888871, 58701.152083333116, 58701.152777777985, 58701.15347222239, 58701.15416666679, 58701.154861111194, 58701.1555555556, 58701.15625, 58701.1569444444, 58701.157638888806, 58701.15833333321, 58701.15902777761, 58701.159722222015, 58701.160416666884, 58701.16111111129, 58701.16180555569, 58701.16250000009, 58701.163194444496, 58701.1638888889, 58701.1645833333, 58701.165277777705, 58701.16597222211, 58701.16666666651, 58701.167361110914, 58701.16805555578, 58701.168750000186, 58701.16944444459, 58701.17013888899, 58701.170833333395, 58701.1715277778, 58701.1722222222, 58701.172916666605, 58701.17361111101, 58701.17430555541, 58701.174999999814, 58701.17569444422, 58701.176388889086, 58701.17708333349, 58701.17777777789, 58701.178472222295, 58701.1791666667, 58701.1798611111, 58701.180555555504, 58701.18124999991, 58701.18194444431, 58701.18263888871, 58701.183333333116, 58701.184027777985, 58701.18472222239, 58701.18541666679, 58701.186111111194, 58701.1868055556, 58701.1875, 58701.1881944444, 58701.188888888806, 58701.18958333321, 58701.19027777761, 58701.190972222015, 58701.191666666884, 58701.19236111129, 58701.19305555569, 58701.19375000009, 58701.194444444496, 58701.1951388889, 58701.1958333333, 58701.196527777705, 58701.19722222211, 58701.19791666651, 58701.198611110914, 58701.19930555578, 58701.200000000186, 58701.20069444459, 58701.20138888899, 58701.202083333395, 58701.2027777778, 58701.2034722222, 58701.204166666605, 58701.20486111101, 58701.20555555541, 58701.206249999814, 58701.20694444422, 58701.207638889086, 58701.20833333349, 58701.20902777789, 58701.209722222295, 58701.2104166667, 58701.2111111111, 58701.211805555504, 58701.21249999991, 58701.21319444431, 58701.21388888871, 58701.214583333116, 58701.215277777985, 58701.21597222239, 58701.21666666679, 58701.217361111194, 58701.2180555556, 58701.21875, 58701.2194444444, 58701.220138888806, 58701.22083333321, 58701.22152777761, 58701.222222222015, 58701.222916666884, 58701.22361111129, 58701.22430555569, 58701.22500000009, 58701.225694444496, 58701.2263888889, 58701.2270833333, 58701.227777777705, 58701.22847222211, 58701.22916666651, 58701.229861110914, 58701.23055555578, 58701.231250000186, 58701.23194444459, 58701.23263888899, 58701.233333333395, 58701.2340277778, 58701.2347222222, 58701.235416666605, 58701.23611111101, 58701.23680555541, 58701.237499999814, 58701.23819444422, 58701.238888889086, 58701.23958333349, 58701.24027777789, 58701.240972222295, 58701.2416666667, 58701.2423611111, 58701.243055555504, 58701.24374999991, 58701.24444444431, 58701.24513888871, 58701.245833333116, 58701.246527777985, 58701.24722222239, 58701.24791666679, 58701.248611111194, 58701.2493055556, 58701.25, 58701.2506944444, 58701.251388888806, 58701.25208333321, 58701.25277777761, 58701.253472222015, 58701.254166666884, 58701.25486111129, 58701.25555555569, 58701.25625000009, 58701.256944444496, 58701.2576388889, 58701.2583333333, 58701.259027777705, 58701.25972222211, 58701.26041666651, 58701.261111110914, 58701.26180555578, 58701.262500000186, 58701.26319444459, 58701.26388888899, 58701.264583333395, 58701.2652777778, 58701.2659722222, 58701.266666666605, 58701.26736111101, 58701.26805555541, 58701.268749999814, 58701.26944444422, 58701.270138889086, 58701.27083333349, 58701.27152777789, 58701.272222222295, 58701.2729166667, 58701.2736111111, 58701.274305555504, 58701.27499999991, 58701.27569444431, 58701.27638888871, 58701.277083333116, 58701.277777777985, 58701.27847222239, 58701.27916666679, 58701.279861111194, 58701.2805555556, 58701.28125, 58701.2819444444, 58701.282638888806, 58701.28333333321, 58701.28402777761, 58701.284722222015, 58701.285416666884, 58701.28611111129, 58701.28680555569, 58701.28750000009, 58701.288194444496, 58701.2888888889, 58701.2895833333, 58701.290277777705, 58701.29097222211, 58701.29166666651, 58701.292361110914, 58701.29305555578, 58701.293750000186, 58701.29444444459, 58701.29513888899, 58701.295833333395, 58701.2965277778, 58701.2972222222, 58701.297916666605, 58701.29861111101, 58701.29930555541, 58701.299999999814, 58701.30069444422, 58701.301388889086, 58701.30208333349, 58701.30277777789, 58701.303472222295, 58701.3041666667, 58701.3048611111, 58701.305555555504, 58701.30624999991, 58701.30694444431, 58701.30763888871, 58701.308333333116, 58701.309027777985, 58701.30972222239, 58701.31041666679, 58701.311111111194, 58701.3118055556, 58701.3125, 58701.3131944444, 58701.313888888806, 58701.31458333321, 58701.31527777761, 58701.315972222015, 58701.316666666884, 58701.31736111129, 58701.31805555569, 58701.31875000009, 58701.319444444496, 58701.3201388889, 58701.3208333333, 58701.321527777705, 58701.32222222211, 58701.32291666651, 58701.323611110914, 58701.32430555578, 58701.325000000186, 58701.32569444459, 58701.32638888899, 58701.327083333395, 58701.3277777778, 58701.3284722222, 58701.329166666605, 58701.32986111101, 58701.33055555541, 58701.331249999814, 58701.33194444422, 58701.332638889086, 58701.33333333349, 58701.33402777789, 58701.334722222295, 58701.3354166667, 58701.3361111111, 58701.336805555504, 58701.33749999991, 58701.33819444431, 58701.33888888871, 58701.339583333116, 58701.340277777985, 58701.34097222239, 58701.34166666679, 58701.342361111194, 58701.3430555556, 58701.34375, 58701.3444444444, 58701.345138888806, 58701.34583333321, 58701.34652777761, 58701.347222222015, 58701.347916666884, 58701.34861111129, 58701.34930555569, 58701.35000000009, 58701.350694444496, 58701.3513888889, 58701.3520833333, 58701.352777777705, 58701.35347222211, 58701.35416666651, 58701.354861110914, 58701.35555555578, 58701.356250000186, 58701.35694444459, 58701.35763888899, 58701.358333333395, 58701.3590277778, 58701.3597222222, 58701.360416666605, 58701.36111111101, 58701.36180555541, 58701.362499999814, 58701.36319444422, 58701.363888889086, 58701.36458333349, 58701.36527777789, 58701.365972222295, 58701.3666666667, 58701.3673611111, 58701.368055555504, 58701.36874999991, 58701.36944444431, 58701.37013888871, 58701.370833333116, 58701.371527777985, 58701.37222222239, 58701.37291666679, 58701.373611111194, 58701.3743055556, 58701.375, 58701.3756944444, 58701.376388888806, 58701.37708333321, 58701.37777777761, 58701.378472222015, 58701.379166666884, 58701.37986111129, 58701.38055555569, 58701.38125000009, 58701.381944444496, 58701.3826388889, 58701.3833333333, 58701.384027777705, 58701.38472222211, 58701.38541666651, 58701.386111110914, 58701.38680555578, 58701.387500000186, 58701.38819444459, 58701.38888888899, 58701.389583333395, 58701.3902777778, 58701.3909722222, 58701.391666666605, 58701.39236111101, 58701.39305555541, 58701.393749999814, 58701.39444444422, 58701.395138889086, 58701.39583333349, 58701.39652777789, 58701.397222222295, 58701.3979166667, 58701.3986111111, 58701.399305555504, 58701.39999999991, 58701.40069444431, 58701.40138888871, 58701.402083333116, 58701.402777777985, 58701.40347222239, 58701.40416666679, 58701.404861111194, 58701.4055555556, 58701.40625, 58701.4069444444, 58701.407638888806, 58701.40833333321, 58701.40902777761, 58701.409722222015, 58701.410416666884, 58701.41111111129, 58701.41180555569, 58701.41250000009, 58701.413194444496, 58701.4138888889, 58701.4145833333, 58701.415277777705, 58701.41597222211, 58701.41666666651, 58701.417361110914, 58701.41805555578, 58701.418750000186, 58701.41944444459, 58701.42013888899, 58701.420833333395, 58701.4215277778, 58701.4222222222, 58701.422916666605, 58701.42361111101, 58701.42430555541, 58701.424999999814, 58701.42569444422, 58701.426388889086, 58701.42708333349, 58701.42777777789, 58701.428472222295, 58701.4291666667, 58701.4298611111, 58701.430555555504, 58701.43124999991, 58701.43194444431, 58701.43263888871, 58701.433333333116, 58701.434027777985, 58701.43472222239, 58701.43541666679, 58701.436111111194, 58701.4368055556, 58701.4375, 58701.4381944444, 58701.438888888806, 58701.43958333321, 58701.44027777761, 58701.440972222015, 58701.441666666884, 58701.44236111129, 58701.44305555569, 58701.44375000009, 58701.444444444496, 58701.4451388889, 58701.4458333333, 58701.446527777705, 58701.44722222211, 58701.44791666651, 58701.448611110914, 58701.44930555578, 58701.450000000186, 58701.45069444459, 58701.45138888899, 58701.452083333395, 58701.4527777778, 58701.4534722222, 58701.454166666605, 58701.45486111101, 58701.45555555541, 58701.456249999814, 58701.45694444422, 58701.457638889086, 58701.45833333349, 58701.45902777789, 58701.459722222295, 58701.4604166667, 58701.4611111111, 58701.461805555504, 58701.46249999991, 58701.46319444431, 58701.46388888871, 58701.464583333116, 58701.465277777985, 58701.46597222239, 58701.46666666679, 58701.467361111194, 58701.4680555556, 58701.46875, 58701.4694444444, 58701.470138888806, 58701.47083333321, 58701.47152777761, 58701.472222222015, 58701.472916666884, 58701.47361111129, 58701.47430555569, 58701.47500000009, 58701.475694444496, 58701.4763888889, 58701.4770833333, 58701.477777777705, 58701.47847222211, 58701.47916666651, 58701.479861110914, 58701.48055555578, 58701.481250000186, 58701.48194444459, 58701.48263888899, 58701.483333333395, 58701.4840277778, 58701.4847222222, 58701.485416666605, 58701.48611111101, 58701.48680555541, 58701.487499999814, 58701.48819444422, 58701.488888889086, 58701.48958333349, 58701.49027777789, 58701.490972222295, 58701.4916666667, 58701.4923611111, 58701.493055555504, 58701.49374999991, 58701.49444444431, 58701.49513888871, 58701.495833333116, 58701.496527777985, 58701.49722222239, 58701.49791666679, 58701.498611111194, 58701.4993055556, 58701.5, 58701.5006944444, 58701.501388888806, 58701.50208333321, 58701.50277777761, 58701.503472222015, 58701.504166666884, 58701.50486111129, 58701.50555555569, 58701.50625000009, 58701.506944444496, 58701.5076388889, 58701.5083333333, 58701.509027777705, 58701.50972222211, 58701.51041666651, 58701.511111110914, 58701.51180555578, 58701.512500000186, 58701.51319444459, 58701.51388888899, 58701.514583333395, 58701.5152777778, 58701.5159722222, 58701.516666666605, 58701.51736111101, 58701.51805555541, 58701.518749999814, 58701.51944444422, 58701.520138889086, 58701.52083333349, 58701.52152777789, 58701.522222222295, 58701.5229166667, 58701.5236111111, 58701.524305555504, 58701.52499999991, 58701.52569444431, 58701.52638888871, 58701.527083333116, 58701.527777777985, 58701.52847222239, 58701.52916666679, 58701.529861111194, 58701.5305555556, 58701.53125, 58701.5319444444, 58701.532638888806, 58701.53333333321, 58701.53402777761, 58701.534722222015, 58701.535416666884, 58701.53611111129, 58701.53680555569, 58701.53750000009, 58701.538194444496, 58701.5388888889, 58701.5395833333, 58701.540277777705, 58701.54097222211, 58701.54166666651, 58701.542361110914, 58701.54305555578, 58701.543750000186, 58701.54444444459, 58701.54513888899, 58701.545833333395, 58701.5465277778, 58701.5472222222, 58701.547916666605, 58701.54861111101, 58701.54930555541, 58701.549999999814, 58701.55069444422, 58701.551388889086, 58701.55208333349, 58701.55277777789, 58701.553472222295, 58701.5541666667, 58701.5548611111, 58701.555555555504, 58701.55624999991, 58701.55694444431, 58701.55763888871, 58701.558333333116, 58701.559027777985, 58701.55972222239, 58701.56041666679, 58701.561111111194, 58701.5618055556, 58701.5625, 58701.5631944444, 58701.563888888806, 58701.56458333321, 58701.56527777761, 58701.565972222015, 58701.566666666884, 58701.56736111129, 58701.56805555569, 58701.56875000009, 58701.569444444496, 58701.5701388889, 58701.5708333333, 58701.571527777705, 58701.57222222211, 58701.57291666651, 58701.573611110914, 58701.57430555578, 58701.575000000186, 58701.57569444459, 58701.57638888899, 58701.577083333395, 58701.5777777778, 58701.5784722222, 58701.579166666605, 58701.57986111101, 58701.58055555541, 58701.581249999814, 58701.58194444422, 58701.582638889086, 58701.58333333349, 58701.58402777789, 58701.584722222295, 58701.5854166667, 58701.5861111111, 58701.586805555504, 58701.58749999991, 58701.58819444431, 58701.58888888871, 58701.589583333116, 58701.590277777985, 58701.59097222239, 58701.59166666679, 58701.592361111194, 58701.5930555556, 58701.59375, 58701.5944444444, 58701.595138888806, 58701.59583333321, 58701.59652777761, 58701.597222222015, 58701.597916666884, 58701.59861111129, 58701.59930555569, 58701.60000000009, 58701.600694444496, 58701.6013888889, 58701.6020833333, 58701.602777777705, 58701.60347222211, 58701.60416666651, 58701.604861110914, 58701.60555555578, 58701.606250000186, 58701.60694444459, 58701.60763888899, 58701.608333333395, 58701.6090277778, 58701.6097222222, 58701.610416666605, 58701.61111111101, 58701.61180555541, 58701.612499999814, 58701.61319444422, 58701.613888889086, 58701.61458333349, 58701.61527777789, 58701.615972222295, 58701.6166666667, 58701.6173611111, 58701.618055555504, 58701.61874999991, 58701.61944444431, 58701.62013888871, 58701.620833333116, 58701.621527777985, 58701.62222222239, 58701.62291666679, 58701.623611111194, 58701.6243055556, 58701.625, 58701.6256944444, 58701.626388888806, 58701.62708333321, 58701.62777777761, 58701.628472222015, 58701.629166666884, 58701.62986111129, 58701.63055555569, 58701.63125000009, 58701.631944444496, 58701.6326388889, 58701.6333333333, 58701.634027777705, 58701.63472222211, 58701.63541666651, 58701.636111110914, 58701.63680555578, 58701.637500000186, 58701.63819444459, 58701.63888888899, 58701.639583333395, 58701.6402777778, 58701.6409722222, 58701.641666666605, 58701.64236111101, 58701.64305555541, 58701.643749999814, 58701.64444444422, 58701.645138889086, 58701.64583333349, 58701.64652777789, 58701.647222222295, 58701.6479166667, 58701.6486111111, 58701.649305555504, 58701.64999999991, 58701.65069444431, 58701.65138888871, 58701.652083333116, 58701.652777777985, 58701.65347222239, 58701.65416666679, 58701.654861111194, 58701.6555555556, 58701.65625, 58701.6569444444, 58701.657638888806, 58701.65833333321, 58701.65902777761, 58701.659722222015, 58701.660416666884, 58701.66111111129, 58701.66180555569, 58701.66250000009, 58701.663194444496, 58701.6638888889, 58701.6645833333, 58701.665277777705, 58701.66597222211, 58701.66666666651, 58701.667361110914, 58701.66805555578, 58701.668750000186, 58701.66944444459, 58701.67013888899, 58701.670833333395, 58701.6715277778, 58701.6722222222, 58701.672916666605, 58701.67361111101, 58701.67430555541, 58701.674999999814, 58701.67569444422, 58701.676388889086, 58701.67708333349, 58701.67777777789, 58701.678472222295, 58701.6791666667, 58701.6798611111, 58701.680555555504, 58701.68124999991, 58701.68194444431, 58701.68263888871, 58701.683333333116, 58701.684027777985, 58701.68472222239, 58701.68541666679, 58701.686111111194, 58701.6868055556, 58701.6875, 58701.6881944444, 58701.688888888806, 58701.68958333321, 58701.69027777761, 58701.690972222015, 58701.691666666884, 58701.69236111129, 58701.69305555569, 58701.69375000009, 58701.694444444496, 58701.6951388889, 58701.6958333333, 58701.696527777705, 58701.69722222211, 58701.69791666651, 58701.698611110914, 58701.69930555578, 58701.700000000186, 58701.70069444459, 58701.70138888899, 58701.702083333395, 58701.7027777778, 58701.7034722222, 58701.704166666605, 58701.70486111101, 58701.70555555541, 58701.706249999814, 58701.70694444422, 58701.707638889086, 58701.70833333349, 58701.70902777789, 58701.709722222295, 58701.7104166667, 58701.7111111111, 58701.711805555504, 58701.71249999991, 58701.71319444431, 58701.71388888871, 58701.714583333116, 58701.715277777985, 58701.71597222239, 58701.71666666679, 58701.717361111194, 58701.7180555556, 58701.71875, 58701.7194444444, 58701.720138888806, 58701.72083333321, 58701.72152777761, 58701.722222222015, 58701.722916666884, 58701.72361111129, 58701.72430555569, 58701.72500000009, 58701.725694444496, 58701.7263888889, 58701.7270833333, 58701.727777777705, 58701.72847222211, 58701.72916666651, 58701.729861110914, 58701.73055555578, 58701.731250000186, 58701.73194444459, 58701.73263888899, 58701.733333333395, 58701.7340277778, 58701.7347222222, 58701.735416666605, 58701.73611111101, 58701.73680555541, 58701.737499999814, 58701.73819444422, 58701.738888889086, 58701.73958333349, 58701.74027777789, 58701.740972222295, 58701.7416666667, 58701.7423611111, 58701.743055555504, 58701.74374999991, 58701.74444444431, 58701.74513888871, 58701.745833333116, 58701.746527777985, 58701.74722222239, 58701.74791666679, 58701.748611111194, 58701.7493055556, 58701.75, 58701.7506944444, 58701.751388888806, 58701.75208333321, 58701.75277777761, 58701.753472222015, 58701.754166666884, 58701.75486111129, 58701.75555555569, 58701.75625000009, 58701.756944444496, 58701.7576388889, 58701.7583333333, 58701.759027777705, 58701.75972222211, 58701.76041666651, 58701.761111110914, 58701.76180555578, 58701.762500000186, 58701.76319444459, 58701.76388888899, 58701.764583333395, 58701.7652777778, 58701.7659722222, 58701.766666666605, 58701.76736111101, 58701.76805555541, 58701.768749999814, 58701.76944444422, 58701.770138889086, 58701.77083333349, 58701.77152777789, 58701.772222222295, 58701.7729166667, 58701.7736111111, 58701.774305555504, 58701.77499999991, 58701.77569444431, 58701.77638888871, 58701.777083333116, 58701.777777777985, 58701.77847222239, 58701.77916666679, 58701.779861111194, 58701.7805555556, 58701.78125, 58701.7819444444, 58701.782638888806, 58701.78333333321, 58701.78402777761, 58701.784722222015, 58701.785416666884, 58701.78611111129, 58701.78680555569, 58701.78750000009, 58701.788194444496, 58701.7888888889, 58701.7895833333, 58701.790277777705, 58701.79097222211, 58701.79166666651, 58701.792361110914, 58701.79305555578, 58701.793750000186, 58701.79444444459, 58701.79513888899, 58701.795833333395, 58701.7965277778, 58701.7972222222, 58701.797916666605, 58701.79861111101, 58701.79930555541, 58701.799999999814, 58701.80069444422, 58701.801388889086, 58701.80208333349, 58701.80277777789, 58701.803472222295, 58701.8041666667, 58701.8048611111, 58701.805555555504, 58701.80624999991, 58701.80694444431, 58701.80763888871, 58701.808333333116, 58701.809027777985, 58701.80972222239, 58701.81041666679, 58701.811111111194, 58701.8118055556, 58701.8125, 58701.8131944444, 58701.813888888806, 58701.81458333321, 58701.81527777761, 58701.815972222015, 58701.816666666884, 58701.81736111129, 58701.81805555569, 58701.81875000009, 58701.819444444496, 58701.8201388889, 58701.8208333333, 58701.821527777705, 58701.82222222211, 58701.82291666651, 58701.823611110914, 58701.82430555578, 58701.825000000186, 58701.82569444459, 58701.82638888899, 58701.827083333395, 58701.8277777778, 58701.8284722222, 58701.829166666605, 58701.82986111101, 58701.83055555541, 58701.831249999814, 58701.83194444422, 58701.832638889086, 58701.83333333349, 58701.83402777789, 58701.834722222295, 58701.8354166667, 58701.8361111111, 58701.836805555504, 58701.83749999991, 58701.83819444431, 58701.83888888871, 58701.839583333116, 58701.840277777985, 58701.84097222239, 58701.84166666679, 58701.842361111194, 58701.8430555556, 58701.84375, 58701.8444444444, 58701.845138888806, 58701.84583333321, 58701.84652777761, 58701.847222222015, 58701.847916666884, 58701.84861111129, 58701.84930555569, 58701.85000000009, 58701.850694444496, 58701.8513888889, 58701.8520833333, 58701.852777777705, 58701.85347222211, 58701.85416666651, 58701.854861110914, 58701.85555555578, 58701.856250000186, 58701.85694444459, 58701.85763888899, 58701.858333333395, 58701.8590277778, 58701.8597222222, 58701.860416666605, 58701.86111111101, 58701.86180555541, 58701.862499999814, 58701.86319444422, 58701.863888889086, 58701.86458333349, 58701.86527777789, 58701.865972222295, 58701.8666666667, 58701.8673611111, 58701.868055555504, 58701.86874999991, 58701.86944444431, 58701.87013888871, 58701.870833333116, 58701.871527777985, 58701.87222222239, 58701.87291666679, 58701.873611111194, 58701.8743055556, 58701.875, 58701.8756944444, 58701.876388888806, 58701.87708333321, 58701.87777777761, 58701.878472222015, 58701.879166666884, 58701.87986111129, 58701.88055555569, 58701.88125000009, 58701.881944444496, 58701.8826388889, 58701.8833333333, 58701.884027777705, 58701.88472222211, 58701.88541666651, 58701.886111110914, 58701.88680555578, 58701.887500000186, 58701.88819444459, 58701.88888888899, 58701.889583333395, 58701.8902777778, 58701.8909722222, 58701.891666666605, 58701.89236111101, 58701.89305555541, 58701.893749999814, 58701.89444444422, 58701.895138889086, 58701.89583333349, 58701.89652777789, 58701.897222222295, 58701.8979166667, 58701.8986111111, 58701.899305555504, 58701.89999999991, 58701.90069444431, 58701.90138888871, 58701.902083333116, 58701.902777777985, 58701.90347222239, 58701.90416666679, 58701.904861111194, 58701.9055555556, 58701.90625, 58701.9069444444, 58701.907638888806, 58701.90833333321, 58701.90902777761, 58701.909722222015, 58701.910416666884, 58701.91111111129, 58701.91180555569, 58701.91250000009, 58701.913194444496, 58701.9138888889, 58701.9145833333, 58701.915277777705, 58701.91597222211, 58701.91666666651, 58701.917361110914, 58701.91805555578, 58701.918750000186, 58701.91944444459, 58701.92013888899, 58701.920833333395, 58701.9215277778, 58701.9222222222, 58701.922916666605, 58701.92361111101, 58701.92430555541, 58701.924999999814, 58701.92569444422, 58701.926388889086, 58701.92708333349, 58701.92777777789, 58701.928472222295, 58701.9291666667, 58701.9298611111, 58701.930555555504, 58701.93124999991, 58701.93194444431, 58701.93263888871, 58701.933333333116, 58701.934027777985, 58701.93472222239, 58701.93541666679, 58701.936111111194, 58701.9368055556, 58701.9375, 58701.9381944444, 58701.938888888806, 58701.93958333321, 58701.94027777761, 58701.940972222015, 58701.941666666884, 58701.94236111129, 58701.94305555569, 58701.94375000009, 58701.944444444496, 58701.9451388889, 58701.9458333333, 58701.946527777705, 58701.94722222211, 58701.94791666651, 58701.948611110914, 58701.94930555578, 58701.950000000186, 58701.95069444459, 58701.95138888899, 58701.952083333395, 58701.9527777778, 58701.9534722222, 58701.954166666605, 58701.95486111101, 58701.95555555541, 58701.956249999814, 58701.95694444422, 58701.957638889086, 58701.95833333349, 58701.95902777789, 58701.959722222295, 58701.9604166667, 58701.9611111111, 58701.961805555504, 58701.96249999991, 58701.96319444431, 58701.96388888871, 58701.964583333116, 58701.965277777985, 58701.96597222239, 58701.96666666679, 58701.967361111194, 58701.9680555556, 58701.96875, 58701.9694444444, 58701.970138888806, 58701.97083333321, 58701.97152777761, 58701.972222222015, 58701.972916666884, 58701.97361111129, 58701.97430555569, 58701.97500000009, 58701.975694444496, 58701.9763888889, 58701.9770833333, 58701.977777777705, 58701.97847222211, 58701.97916666651, 58701.979861110914, 58701.98055555578, 58701.981250000186, 58701.98194444459, 58701.98263888899, 58701.983333333395, 58701.9840277778, 58701.9847222222, 58701.985416666605, 58701.98611111101, 58701.98680555541, 58701.987499999814, 58701.98819444422, 58701.988888889086, 58701.98958333349, 58701.99027777789, 58701.990972222295, 58701.9916666667, 58701.9923611111, 58701.993055555504, 58701.99374999991, 58701.99444444431, 58701.99513888871, 58701.995833333116, 58701.996527777985, 58701.99722222239, 58701.99791666679, 58701.998611111194, 58701.9993055556])

# RA and Dec of target in radians
ra  = np.array([5.328367306070527] * ntimes)
dec = np.array([-0.5083887159808493] * ntimes)

ssobj = np.zeros(ntimes, dtype=bool)
dx = np.zeros(ntimes)
dy = np.zeros(ntimes)
dut = np.zeros(ntimes)
leapsec = 0.0
axisoff = np.zeros(nant) # Offset between az and el axes of dish
sourcename = ['P'] * ntimes
jpx_de421 = 'data/DE421_little_Endian'

geodelay, drydelay, wetdelay = almacalc(refx, refy, refz, antx, anty,
                                        antz, temp, pressure,
                                        humidity, mjd, ra, dec, ssobj,
                                        dx, dy, dut, leapsec, axisoff,
                                        sourcename, jpx_de421)

geodelay_plot = []
for i in range(0,1440):
    geodelay_plot.append(geodelay[0][i])
#
geodelay_plot_array = np.array(geodelay_plot)

print("---------------------------------------------------------------------")
print('geodelay:')
# for i in range(0,1440):
#     print(str(geodelay[0,i])+",")
#     print(geodelay)
print("---------------------------------------------------------------------")
print('geodelay_plot_array:')
for i in range(0,1440):
    print(str(geodelay_plot_array[i]))
print("---------------------------------------------------------------------")
print('drydelay:')
print(drydelay)
print("---------------------------------------------------------------------")
print('wetdelay:')
print(wetdelay)
print("---------------------------------------------------------------------")

index = list(range(1440))
plt.plot(index , geodelay_plot_array)
plt.show()